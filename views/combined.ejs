<!DOCTYPE html>
<html>
<head>
  <link rel="shortcut icon" href="/img/favicon_57.png"/>
  <link rel="apple-touch-icon" href="/img/favicon_57.png"/>
  <link rel="apple-touch-icon" sizes="72x72" href="/img/favicon_72.png"/>
  <link rel="apple-touch-icon" sizes="114x114" href="/img/favicon_114.png"/>
  <title>NCM & Twilio</title>
  <link rel="stylesheet" href="/css/bell.css">
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.4/jquery.min.js"></script>
  <script type="text/javascript" src="/js/Tone.js"></script>
  <script type="text/javascript" src="/js/socket.io.slim.js"></script>
  <script type="text/javascript" src="/js/socket.js"></script>

</head>
<body class="vbox viewport">
  <div id="log"></div>
  <h2>All the songs..........</h2>

  
</body>
<script type="text/javascript">
  const notes = <%- JSON.stringify(notes) %>;
  const genre = `<%- genre %>`;
  //set the transport
  Tone.Transport.bpm.value = genre == 'HipHop' ? 90 : 100;
  Tone.Transport.loop = true;
  Tone.Transport.loopStart = 0;
  Tone.Transport.loopEnd = "4m";

  for (var i=0; i<notes.length; i++) {
    window[notes[i]] = new Tone.Player({
      url: `/audio/${genre}/${notes[i]}.mp3`,
      loop: true,
      mute: true
    }).toMaster().sync().start(0);
  }

  $(document).ready(function () {
    // setTimeout(() => {
    //   console.log(socket);
    //   socket.on('start_song', () => {
    //     Tone.Transport.start();
    //     console.log('Starting Song!');
    //   })

    //   socket.on('play_sound', (msg) => {
    //     console.log(msg);
    //     window[msg].mute = false;
    //   })
    // }, 10000)
  });
</script>
</html>